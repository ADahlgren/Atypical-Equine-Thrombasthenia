#make it so I can't mess up originial file?
chmod a-w file

#FastQC individual fastq files
fastqc file.fastq.gz

#need to trim?
TrimmomaticPE read1.fq read2.fq out_R1.fq orphan1 out_R2.fq orphan2 ILLUMINACLIP:TruSeq3-PE.fa:2:40:15 LEADING:2 TRAILING:2 SLIDINGWINDOW:4:2 MINLEN:25

#map to reference with bwa
bwa mem -t 4 [how many threads?] ref.fa read1.fq read2.gq > horseID.sam

#index ref
samtools faidx ref.fa
#convert to bam
samtools import ref.fa.fai horseID.sam horseID.bam
#sort bam file by position in genome
samtools sort horseID.bam horseID.sorted
#index bam file
samtools index horseID.sorted.bam
#can visualize for funsies
samtools tview horseID.sorted.bam ref.fa

#Call variants
samtools mpileup -uD -f ref.fa horseID.sorted.bam | bcftools view -bvcg - > horseID. variants.raw.bcf
bcftools horseID.view variants.raw.bcf > horseID.variants.vcf

#compare variants between control and affected?
#GATK CombineVariants to merge all vcfs
#GATK SelectVariants to filter out variants that only occur in affected samples
