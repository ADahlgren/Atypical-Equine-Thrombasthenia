
#FastQC individual fastq files
fastqc file.fastq.gz

#trim
trimmomatic PE FASTQFILENAME_R1_001.fastq FASTQFILENAME_R2_001.fastq\  FASTQFILENAME_R1.qc.fq FASTQFILENAME_R1_s1_se FASTQFILENAME_R2.qc.fq FASTQFILENAME_R2_s2_se\ SLIDINGWINDOW:3:28

#fastqc again
fastqc file_R.qc.fq

#remove adapters - need to be unzipped?
scythe -a adapters.fasta.txt -o scythe_filename.fastq file.fastq.gz

#map to reference with bwa
bwa mem -t 4 [how many threads?] ref.fa read1.fq read2.gq > horseID.sam

#index ref
samtools faidx ref.fa
#convert to bam
samtools import ref.fa.fai horseID.sam horseID.bam
#sort bam file by position in genome
samtools sort horseID.bam horseID.sorted
#index bam file
samtools index horseID.sorted.bam
#can visualize for funsies
samtools tview horseID.sorted.bam ref.fa

#Call variants
samtools mpileup -uD -f ref.fa horseID.sorted.bam | bcftools view -bvcg - > horseID. variants.raw.bcf
bcftools horseID.view variants.raw.bcf > horseID.variants.vcf

#compare variants between control and affected?
#GATK CombineVariants to merge all vcfs
#GATK SelectVariants to filter out variants that only occur in affected samples
